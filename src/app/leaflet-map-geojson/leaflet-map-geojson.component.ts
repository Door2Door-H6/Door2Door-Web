import {AfterViewInit, Component, OnInit} from '@angular/core';
import * as L from 'leaflet';

@Component({
  selector: 'app-leaflet-map-geojson',
  templateUrl: './leaflet-map-geojson.component.html',
  styleUrls: ['./leaflet-map-geojson.component.scss']
})
export class LeafletMapGeojsonComponent implements AfterViewInit {

  private poiLayer;
  private map;

  private initMap(): void {
    this.map = L.map('map', {
      zoom: 0,
      minZoom: 12,
      maxZoom: 20
    });

    // Set the map option to CRS EPSG3395 as that is the format our geoJSON is in
    this.map.options.crs = L.CRS.EPSG3395;

    // region GeoJSON
    const wallsGeoJson = {
      type: 'FeatureCollection',
      name: 'WallPolygonColor',
      crs: {type: 'name', properties: {name: 'urn:ogc:def:crs:OGC:1.3:CRS84'}},
      features: [
        {
          type: 'Feature', properties: {}, geometry: {
            type: 'MultiPolygon',
            coordinates: [[[[0.017478541144365, 0.00064558810056], [0.017478541144365, 0.000646061085797], [0.013961884742056, 0.000646061085797], [0.013961884742056, 0.000980677792271], [0.017148877401399, 0.000980677792271], [0.017148877401399, 0.007130204821869], [0.013915013345476, 0.007130204821869], [0.013915013345476, 0.012746738013385], [0.014138440526312, 0.012746738013385], [0.014138440526312, 0.012638195591449], [0.014022829145876, 0.012638195591449], [0.014022829145876, 0.007238747245639], [0.017148877401399, 0.007238747245639], [0.017148877401399, 0.010367824901784], [0.014994750587746, 0.010367824901784], [0.014994750587746, 0.0104763673246], [0.014994768554051, 0.0104763673246], [0.014994768554051, 0.012638195591449], [0.014946924282019, 0.012638195591449], [0.014946924282019, 0.012746738013385], [0.015171700732412, 0.012746738013385], [0.015171700732412, 0.012638195591449], [0.015102584354451, 0.012638195591449], [0.015102584354451, 0.0104763673246], [0.016079207578518, 0.0104763673246], [0.016079207578518, 0.012638195591449], [0.015980184488119, 0.012638195591449], [0.015980184488119, 0.012746738013385], [0.016292939242492, 0.012746738013385], [0.016292939242492, 0.012638195591449], [0.016187023378918, 0.012638195591449], [0.016187023378918, 0.0104763673246], [0.017148877401399, 0.0104763673246], [0.017148877401399, 0.012638195591449], [0.0171014229982, 0.012638195591449], [0.0171014229982, 0.012746738013385], [0.017148886384552, 0.012746738013385], [0.017148886384552, 0.012746728969691], [0.029940292362543, 0.012746728969691], [0.029940292362543, 0.012602029856951], [0.029374056391188, 0.012602029856951], [0.029374056391188, 0.012556811384202], [0.029940292362543, 0.012556811384202], [0.029940292362543, 0.012412112271355], [0.017481254056523, 0.012412112271355], [0.017481254056523, 0.000754130525187], [0.044758200603457, 0.000754130525187], [0.044758200603457, 0.012412112271355], [0.031072764305251, 0.012412112271355], [0.031072764305251, 0.012556992258093], [0.031639000276606, 0.012556992258093], [0.031639000276606, 0.012602210730842], [0.031072764305251, 0.012602210730842], [0.031072764305251, 0.012746728969691], [0.034098668372901, 0.012746728969691], [0.034098668372901, 0.012779215729229], [0.034206484173301, 0.012779215729229], [0.034206484173301, 0.012746728969691], [0.044530656443674, 0.012746728969691], [0.044530656443674, 0.012835901606615], [0.044863033098798, 0.012835901606615], [0.044863033098798, 0.01273149757934], [0.044866016403857, 0.01273149757934], [0.044866016403857, 0.00064558810056], [0.017478541144365, 0.00064558810056]]]]
          }
        },
        {
          type: 'Feature', properties: {}, geometry: {
            type: 'MultiPolygon',
            coordinates: [[[[0.008420733811483, 0.014637411882942], [0.008460750164129, 0.014637411882942], [0.008460750164129, 0.021510610514101], [0.000846212997641, 0.021510610514101], [0.000846212997641, 0.014637411882942], [0.007702081584187, 0.014637411882942], [0.007702081584187, 0.014528869461869], [0.007624362040751, 0.014528869461869], [0.007624362040751, 0.014012846202551], [0.007516546240351, 0.014012846202551], [0.007516546240351, 0.014528869461869], [0.000846212997641, 0.014528869461869], [0.000846212997641, 0.012746728969691], [0.005823539933397, 0.012746728969691], [0.005823539933397, 0.012746738013385], [0.007516545342036, 0.012746738013385], [0.007516545342036, 0.013289350641726], [0.007624361142436, 0.013289350641726], [0.007624361142436, 0.012746738013385], [0.012215858070402, 0.012746738013385], [0.012215858070402, 0.012266885006666], [0.012108042270002, 0.012266885006666], [0.012108042270002, 0.012638195591449], [0.005823548916549, 0.012638195591449], [0.005823548916549, 0.000980677792271], [0.012256205003072, 0.000980677792271], [0.012256205003072, 0.000646061085797], [0.005491172261425, 0.000646061085797], [0.005491172261425, 0.012412112271355], [0.000513836342516, 0.012412112271355], [0.000513836342516, 0.021845227196339], [0.022266369369251, 0.021845227196339], [0.022266369369251, 0.021510610514101], [0.015932178519336, 0.021510610514101], [0.015934107202251, 0.016357395048371], [0.015826291401851, 0.016357354351746], [0.015824362718936, 0.021510577956802], [0.015910615359256, 0.021510610514101], [0.00856856596453, 0.021510610514101], [0.00856856596453, 0.014637411882942], [0.014763918594023, 0.014637411882942], [0.014763918594023, 0.014528869461869], [0.008420733811483, 0.014528869461869], [0.008420733811483, 0.014637411882942]]]]
          }
        },
        {
          type: 'Feature',
          properties: {},
          geometry: {
            type: 'MultiPolygon',
            coordinates: [[[[0.012215858070402, 0.000989916830847], [0.012108042270002, 0.000989916830847], [0.012108042270002, 0.011452952494998], [0.012215858070402, 0.011452952494998], [0.012215858070402, 0.000989916830847]]]]
          }
        },
        {
          type: 'Feature', properties: {}, geometry: {
            type: 'MultiPolygon',
            coordinates: [[[[0.041049646090154, 0.019659542667776], [0.041050758204475, 0.019551023763185], [0.041050758204475, 0.017911229255581], [0.041482828991516, 0.017911229255581], [0.041482828991516, 0.017802686836287], [0.040942942404075, 0.017802686836287], [0.040942942404075, 0.019549885162081], [0.040045533520078, 0.019540562017692], [0.040045533520078, 0.017911229255581], [0.040138161503969, 0.017911229255581], [0.040138161503969, 0.017802686836287], [0.040045533520078, 0.017802686836287], [0.040045533520078, 0.017528780465967], [0.039937717719678, 0.017528780465967], [0.039937717719678, 0.017802686836287], [0.039738633984726, 0.017802686836287], [0.039738633984726, 0.017911229255581], [0.039937717719678, 0.017911229255581], [0.039937717719678, 0.021510610514101], [0.036901430025659, 0.021510610514101], [0.036901430025659, 0.017911229255581], [0.038930150229019, 0.017911229255581], [0.038930150229019, 0.017802686836287], [0.036901430025659, 0.017802686836287], [0.036901430025659, 0.016660124578753], [0.036793614225259, 0.016660124578753], [0.036793614225259, 0.021510610514101], [0.034206484173301, 0.021510610514101], [0.034206484173301, 0.016625377800561], [0.034098668372901, 0.016625377800561], [0.034098668372901, 0.018748255720478], [0.033155446307728, 0.018748255720478], [0.033155446307728, 0.018856798139191], [0.034098668372901, 0.018856798139191], [0.034098668372901, 0.021510610514101], [0.031511538320942, 0.021510610514101], [0.031511538320942, 0.018856798139191], [0.03234696255202, 0.018856798139191], [0.03234696255202, 0.018748255720478], [0.031511538320942, 0.018748255720478], [0.031511538320942, 0.016590631926732], [0.031403722520542, 0.016590631926732], [0.031403722520542, 0.021510610514101], [0.023768060571832, 0.021510610514101], [0.023768060571832, 0.014637411882942], [0.029969543304824, 0.014637411882942], [0.029969543304824, 0.014528869461869], [0.023012454348693, 0.014528869461869], [0.023012454348693, 0.014637411882942], [0.023660244771432, 0.014637411882942], [0.023660244771432, 0.021510610514101], [0.023074853124959, 0.021510610514101], [0.023074853124959, 0.021845227196339], [0.044863033098798, 0.021845227196339], [0.044863033098798, 0.014462267173892], [0.044530656443674, 0.014462267173892], [0.044530656443674, 0.014511192656646], [0.041751888792154, 0.014522143666287], [0.041752310102023, 0.014630685182994], [0.044530656443674, 0.014619735982097], [0.044530656443674, 0.017802686836287], [0.042291312747223, 0.017802686836287], [0.042291312747223, 0.017911229255581], [0.044530656443674, 0.017911229255581], [0.044530656443674, 0.021510610514101], [0.040045533520078, 0.021510610514101], [0.040045533520078, 0.019649109862111], [0.041049646090154, 0.019659542667776]]]]
          }
        },
        {
          type: 'Feature', properties: {}, geometry: {
            type: 'MultiPolygon',
            coordinates: [[[[0.036901430025659, 0.014528869461869], [0.036901430025659, 0.0145288685575], [0.034206484173301, 0.014528869461869], [0.034206484173301, 0.014496390841896], [0.034098668372901, 0.014496390841896], [0.034098668372901, 0.014528869461869], [0.030778027060532, 0.014528869461869], [0.030778027060532, 0.014637411882942], [0.031403722520542, 0.014637411882942], [0.031403722520542, 0.015776699430297], [0.031511538320942, 0.015776699430297], [0.031511538320942, 0.014637411882942], [0.034098668372901, 0.014637411882942], [0.034098668372901, 0.015811445304267], [0.034206484173301, 0.015811445304267], [0.034206484173301, 0.014637411882942], [0.036793614225259, 0.014637410978572], [0.036793614225259, 0.015846192082602], [0.036901430025659, 0.015846192082602], [0.036901430025659, 0.014637411882942], [0.039937717719678, 0.014637411882942], [0.039937717719678, 0.016714847973457], [0.040045533520078, 0.016714847973457], [0.040045533520078, 0.014528869461869], [0.036901430025659, 0.014528869461869]]]]
          }
        },
        {
          type: 'Feature',
          properties: {},
          geometry: {
            type: 'MultiPolygon',
            coordinates: [[[[0.022203970592986, 0.014528869461869], [0.015572402349731, 0.014528869461869], [0.015572402349731, 0.014637411882942], [0.01582693549391, 0.014637411882942], [0.015826595930732, 0.015543421854369], [0.015934411731132, 0.015543462550994], [0.01593475129431, 0.014637411882942], [0.022203970592986, 0.014637411882942], [0.022203970592986, 0.014528869461869]]]]
          }
        }
      ]
    };

    const roomsGeoJSON = {
      type: 'FeatureCollection',
      name: 'RoomsWithAutoColor',
      crs: {type: 'name', properties: {name: 'urn:ogc:def:crs:OGC:1.3:CRS84'}},
      features: [
        {type: 'Feature', properties: {id: null, name: null, color: null}, geometry: {type: 'MultiPolygon', coordinates: []}},
        {
          type: 'Feature',
          properties: {id: 1, name: 'B16', color: 'green'},
          geometry: {
            type: 'MultiPolygon',
            coordinates: [[[[0.00856856596453, 0.021510610514101], [0.015824362718936, 0.021510577956802], [0.01582693549391, 0.014637411882942], [0.00856856596453, 0.014637411882942], [0.00856856596453, 0.021510610514101]]]]
          }
        },
        {
          type: 'Feature',
          properties: {id: 2, name: 'B24', color: 'green'},
          geometry: {
            type: 'MultiPolygon',
            coordinates: [[[[0.000846212997641, 0.021510610514101], [0.008460750164129, 0.021510610514101], [0.008460750164129, 0.014637411882942], [0.000846212997641, 0.014637411882942], [0.000846212997641, 0.021510610514101]]]]
          }
        },
        {
          type: 'Feature',
          properties: {id: 3, name: 'B25', color: 'green'},
          geometry: {
            type: 'MultiPolygon',
            coordinates: [[[[0.015932178519336, 0.021510610514101], [0.023660244771432, 0.021510610514101], [0.023660244771432, 0.014637411882942], [0.01593475129431, 0.014637411882942], [0.015932178519336, 0.021510610514101]]]]
          }
        },
        {
          type: 'Feature',
          properties: {id: 4, name: 'B26', color: 'green'},
          geometry: {
            type: 'MultiPolygon',
            coordinates: [[[[0.023768060571832, 0.021510610514101], [0.031403722520542, 0.021510610514101], [0.031403722520542, 0.014637411882942], [0.023768060571832, 0.014637411882942], [0.023768060571832, 0.021510610514101]]]]
          }
        },
        {
          type: 'Feature',
          properties: {id: 5, name: 'B30', color: 'green'},
          geometry: {
            type: 'MultiPolygon',
            coordinates: [[[[0.005823548916549, 0.012638195591449], [0.012108042270002, 0.012638195591449], [0.012108076698769, 0.000980670058879], [0.005823548916549, 0.000980677792271], [0.005823548916549, 0.012638195591449]]]]
          }
        },
        {
          type: 'Feature',
          properties: {id: 6, name: 'Wc1', color: 'blue'},
          geometry: {
            type: 'MultiPolygon',
            coordinates: [[[[0.015102584354451, 0.012638195591449], [0.016079207578518, 0.012638195591449], [0.016079207578518, 0.0104763673246], [0.015102584354451, 0.0104763673246], [0.015102584354451, 0.012638195591449]]]]
          }
        },
        {
          type: 'Feature',
          properties: {id: 7, name: 'Wc2', color: 'blue'},
          geometry: {
            type: 'MultiPolygon',
            coordinates: [[[[0.016187023378918, 0.0104763673246], [0.016187023378918, 0.012638195591449], [0.017148877401399, 0.012638195591449], [0.017148877401399, 0.0104763673246], [0.016187023378918, 0.0104763673246]]]]
          }
        },
        {
          type: 'Feature',
          properties: {id: 8, name: 'Wc3', color: 'blue'},
          geometry: {
            type: 'MultiPolygon',
            coordinates: [[[[0.014022829145876, 0.012638195591449], [0.014994768554051, 0.012638195591449], [0.014994750587746, 0.010367824901784], [0.017148877401399, 0.010367824901784], [0.017148877401399, 0.007238747245639], [0.014022829145876, 0.007238747245639], [0.014022829145876, 0.012638195591449]]]]
          }
        },
        {
          type: 'Feature',
          properties: {id: 9, name: 'Atrium', color: 'grey'},
          geometry: {
            type: 'MultiPolygon',
            coordinates: [[[[0.017481254056523, 0.012412112271355], [0.044758200603457, 0.012412112271355], [0.044758200603457, 0.000754130525187], [0.017481254056523, 0.000754130525187], [0.017481254056523, 0.012412112271355]]]]
          }
        },
        {
          type: 'Feature',
          properties: {id: 10, name: 'B12 kontor', color: 'grey'},
          geometry: {
            type: 'MultiPolygon',
            coordinates: [[[[0.031511538320942, 0.021510610514101], [0.034098668372901, 0.021510610514101], [0.034098668372901, 0.018856798139191], [0.031511538320942, 0.018856798139191], [0.031511538320942, 0.021510610514101]]]]
          }
        },
        {
          type: 'Feature',
          properties: {id: 11, name: 'B12', color: 'green'},
          geometry: {
            type: 'MultiPolygon',
            coordinates: [[[[0.031511538320942, 0.018748255720478], [0.034098668372901, 0.018748255720478], [0.034098668372901, 0.014637411882942], [0.031511538320942, 0.014637411882942], [0.031511538320942, 0.018748255720478]]]]
          }
        },
        {
          type: 'Feature',
          properties: {id: 12, name: 'B10', color: 'green'},
          geometry: {
            type: 'MultiPolygon',
            coordinates: [[[[0.034206484173301, 0.021510610514101], [0.036793614225259, 0.021510610514101], [0.036793614225259, 0.014637410978572], [0.034206484173301, 0.014637411882942], [0.034206484173301, 0.021510610514101]]]]
          }
        },
        {
          type: 'Feature',
          properties: {id: 13, name: 'B10-Køkken', color: 'grey'},
          geometry: {
            type: 'MultiPolygon',
            coordinates: [[[[0.036901430025659, 0.021510610514101], [0.039937717719678, 0.021510610514101], [0.039937717719678, 0.017911229255581], [0.036901430025659, 0.017911229255581], [0.036901430025659, 0.021510610514101]]]]
          }
        },
        {
          type: 'Feature',
          properties: {id: 14, name: 'B08 indgang', color: 'grey'},
          geometry: {
            type: 'MultiPolygon',
            coordinates: [[[[0.036901430025659, 0.017802686836287], [0.039937717719678, 0.017802686836287], [0.039937717719678, 0.014637411882942], [0.036901430025659, 0.014637411882942], [0.036901430025659, 0.017802686836287]]]]
          }
        },
        {
          type: 'Feature',
          properties: {id: 15, name: 'B gang trappe', color: 'grey'},
          geometry: {
            type: 'MultiPolygon',
            coordinates: [[[[0.044530656443674, 0.017585789073557], [0.042324835394706, 0.017585789073557], [0.042342629880941, 0.015085663757519], [0.044530656443674, 0.015085663757519], [0.044530656443674, 0.017585789073557]]]]
          }
        },
        {
          type: 'Feature',
          properties: {id: 16, name: 'B02', color: 'green'},
          geometry: {
            type: 'MultiPolygon',
            coordinates: [[[[0.040045533520078, 0.021510610514101], [0.044530656443674, 0.021510610514101], [0.044530656443674, 0.017911229255581], [0.041050758204475, 0.017911229255581], [0.041049646090154, 0.019659542667776], [0.040045533520078, 0.019649109862111], [0.040045533520078, 0.021510610514101]]]]
          }
        },
        {
          type: 'Feature',
          properties: {id: 17, name: 'B02 wc', color: 'blue'},
          geometry: {
            type: 'MultiPolygon',
            coordinates: [[[[0.040045533520078, 0.017911229255581], [0.040045533520078, 0.019540562017692], [0.040942942404075, 0.019549885162081], [0.040942942404075, 0.017919435690466], [0.040045533520078, 0.017911229255581]]]]
          }
        },
        {
          type: 'Feature',
          properties: {id: 18, name: 'B depot', color: 'grey'},
          geometry: {
            type: 'MultiPolygon',
            coordinates: [[[[0.007516546240351, 0.014528869461869], [0.007516545342036, 0.012746738013385], [0.000846212997641, 0.012746728969691], [0.000846212997641, 0.014528869461869], [0.007516546240351, 0.014528869461869]]]]
          }
        }
      ]
    };

    /*
    const testGeoJSON = [
      {
        "type": "Feature",
        "geometry": {
          "type": "MultiPolygon",
          "coordinates": [
            [
              [
                [
                  0.00856856596453,
                  0.021510610514101
                ],
                [
                  0.015824362718936,
                  0.021510577956802
                ],
                [
                  0.01582693549391,
                  0.014637411882942
                ],
                [
                  0.00856856596453,
                  0.014637411882942
                ],
                [
                  0.00856856596453,
                  0.021510610514101
                ]
              ]
            ]
          ]
        },
        "properties": {
          "sqlgeotype": "MultiPolygon",
          "wkt": "MULTIPOLYGON (((0.00856856596453 0.021510610514101, 0.015824362718936 0.021510577956802, 0.01582693549391 0.014637411882942, 0.00856856596453 0.014637411882942, 0.00856856596453 0.021510610514101)))",
          "name": "B16"
        }
      },
      {
        "type": "Feature",
        "geometry": {
          "type": "MultiPolygon",
          "coordinates": [
            [
              [
                [
                  0.000846212997641,
                  0.021510610514101
                ],
                [
                  0.008460750164129,
                  0.021510610514101
                ],
                [
                  0.008460750164129,
                  0.014637411882942
                ],
                [
                  0.000846212997641,
                  0.014637411882942
                ],
                [
                  0.000846212997641,
                  0.021510610514101
                ]
              ]
            ]
          ]
        },
        "properties": {
          "sqlgeotype": "MultiPolygon",
          "wkt": "MULTIPOLYGON (((0.000846212997641 0.021510610514101, 0.008460750164129 0.021510610514101, 0.008460750164129 0.014637411882942, 0.000846212997641 0.014637411882942, 0.000846212997641 0.021510610514101)))",
          "name": "B24"
        }
      },
      {
        "type": "Feature",
        "geometry": {
          "type": "MultiPolygon",
          "coordinates": [
            [
              [
                [
                  0.015932178519336,
                  0.021510610514101
                ],
                [
                  0.023660244771432,
                  0.021510610514101
                ],
                [
                  0.023660244771432,
                  0.014637411882942
                ],
                [
                  0.01593475129431,
                  0.014637411882942
                ],
                [
                  0.015932178519336,
                  0.021510610514101
                ]
              ]
            ]
          ]
        },
        "properties": {
          "sqlgeotype": "MultiPolygon",
          "wkt": "MULTIPOLYGON (((0.015932178519336 0.021510610514101, 0.023660244771432 0.021510610514101, 0.023660244771432 0.014637411882942, 0.01593475129431 0.014637411882942, 0.015932178519336 0.021510610514101)))",
          "name": "B25"
        }
      },
      {
        "type": "Feature",
        "geometry": {
          "type": "MultiPolygon",
          "coordinates": [
            [
              [
                [
                  0.023768060571832,
                  0.021510610514101
                ],
                [
                  0.031403722520542,
                  0.021510610514101
                ],
                [
                  0.031403722520542,
                  0.014637411882942
                ],
                [
                  0.023768060571832,
                  0.014637411882942
                ],
                [
                  0.023768060571832,
                  0.021510610514101
                ]
              ]
            ]
          ]
        },
        "properties": {
          "sqlgeotype": "MultiPolygon",
          "wkt": "MULTIPOLYGON (((0.023768060571832 0.021510610514101, 0.031403722520542 0.021510610514101, 0.031403722520542 0.014637411882942, 0.023768060571832 0.014637411882942, 0.023768060571832 0.021510610514101)))",
          "name": "B26"
        }
      },
      {
        "type": "Feature",
        "geometry": {
          "type": "MultiPolygon",
          "coordinates": [
            [
              [
                [
                  0.005823548916549,
                  0.012638195591449
                ],
                [
                  0.012108042270002,
                  0.012638195591449
                ],
                [
                  0.012108076698769,
                  0.000980670058879
                ],
                [
                  0.005823548916549,
                  0.000980677792271
                ],
                [
                  0.005823548916549,
                  0.012638195591449
                ]
              ]
            ]
          ]
        },
        "properties": {
          "sqlgeotype": "MultiPolygon",
          "wkt": "MULTIPOLYGON (((0.005823548916549 0.012638195591449, 0.012108042270002 0.012638195591449, 0.012108076698769 0.000980670058879, 0.005823548916549 0.000980677792271, 0.005823548916549 0.012638195591449)))",
          "name": "B30"
        }
      },
      {
        "type": "Feature",
        "geometry": {
          "type": "MultiPolygon",
          "coordinates": [
            [
              [
                [
                  0.015102584354451,
                  0.012638195591449
                ],
                [
                  0.016079207578518,
                  0.012638195591449
                ],
                [
                  0.016079207578518,
                  0.0104763673246
                ],
                [
                  0.015102584354451,
                  0.0104763673246
                ],
                [
                  0.015102584354451,
                  0.012638195591449
                ]
              ]
            ]
          ]
        },
        "properties": {
          "sqlgeotype": "MultiPolygon",
          "wkt": "MULTIPOLYGON (((0.015102584354451 0.012638195591449, 0.016079207578518 0.012638195591449, 0.016079207578518 0.0104763673246, 0.015102584354451 0.0104763673246, 0.015102584354451 0.012638195591449)))",
          "name": "Wc1"
        }
      },
      {
        "type": "Feature",
        "geometry": {
          "type": "MultiPolygon",
          "coordinates": [
            [
              [
                [
                  0.016187023378918,
                  0.0104763673246
                ],
                [
                  0.016187023378918,
                  0.012638195591449
                ],
                [
                  0.017148877401399,
                  0.012638195591449
                ],
                [
                  0.017148877401399,
                  0.0104763673246
                ],
                [
                  0.016187023378918,
                  0.0104763673246
                ]
              ]
            ]
          ]
        },
        "properties": {
          "sqlgeotype": "MultiPolygon",
          "wkt": "MULTIPOLYGON (((0.016187023378918 0.0104763673246, 0.016187023378918 0.012638195591449, 0.017148877401399 0.012638195591449, 0.017148877401399 0.0104763673246, 0.016187023378918 0.0104763673246)))",
          "name": "Wc2"
        }
      },
      {
        "type": "Feature",
        "geometry": {
          "type": "MultiPolygon",
          "coordinates": [
            [
              [
                [
                  0.014022829145876,
                  0.012638195591449
                ],
                [
                  0.014994768554051,
                  0.012638195591449
                ],
                [
                  0.014994750587746,
                  0.010367824901784
                ],
                [
                  0.017148877401399,
                  0.010367824901784
                ],
                [
                  0.017148877401399,
                  0.007238747245639
                ],
                [
                  0.014022829145876,
                  0.007238747245639
                ],
                [
                  0.014022829145876,
                  0.012638195591449
                ]
              ]
            ]
          ]
        },
        "properties": {
          "sqlgeotype": "MultiPolygon",
          "wkt": "MULTIPOLYGON (((0.014022829145876 0.012638195591449, 0.014994768554051 0.012638195591449, 0.014994750587746 0.010367824901784, 0.017148877401399 0.010367824901784, 0.017148877401399 0.007238747245639, 0.014022829145876 0.007238747245639, 0.014022829145876 0.012638195591449)))",
          "name": "Wc3"
        }
      },
      {
        "type": "Feature",
        "geometry": {
          "type": "MultiPolygon",
          "coordinates": [
            [
              [
                [
                  0.017481254056523,
                  0.012412112271355
                ],
                [
                  0.044758200603457,
                  0.012412112271355
                ],
                [
                  0.044758200603457,
                  0.000754130525187
                ],
                [
                  0.017481254056523,
                  0.000754130525187
                ],
                [
                  0.017481254056523,
                  0.012412112271355
                ]
              ]
            ]
          ]
        },
        "properties": {
          "sqlgeotype": "MultiPolygon",
          "wkt": "MULTIPOLYGON (((0.017481254056523 0.012412112271355, 0.044758200603457 0.012412112271355, 0.044758200603457 0.000754130525187, 0.017481254056523 0.000754130525187, 0.017481254056523 0.012412112271355)))",
          "name": "Atrium"
        }
      },
      {
        "type": "Feature",
        "geometry": {
          "type": "MultiPolygon",
          "coordinates": [
            [
              [
                [
                  0.031511538320942,
                  0.021510610514101
                ],
                [
                  0.034098668372901,
                  0.021510610514101
                ],
                [
                  0.034098668372901,
                  0.018856798139191
                ],
                [
                  0.031511538320942,
                  0.018856798139191
                ],
                [
                  0.031511538320942,
                  0.021510610514101
                ]
              ]
            ]
          ]
        },
        "properties": {
          "sqlgeotype": "MultiPolygon",
          "wkt": "MULTIPOLYGON (((0.031511538320942 0.021510610514101, 0.034098668372901 0.021510610514101, 0.034098668372901 0.018856798139191, 0.031511538320942 0.018856798139191, 0.031511538320942 0.021510610514101)))",
          "name": "B12 kontor"
        }
      },
      {
        "type": "Feature",
        "geometry": {
          "type": "MultiPolygon",
          "coordinates": [
            [
              [
                [
                  0.031511538320942,
                  0.018748255720478
                ],
                [
                  0.034098668372901,
                  0.018748255720478
                ],
                [
                  0.034098668372901,
                  0.014637411882942
                ],
                [
                  0.031511538320942,
                  0.014637411882942
                ],
                [
                  0.031511538320942,
                  0.018748255720478
                ]
              ]
            ]
          ]
        },
        "properties": {
          "sqlgeotype": "MultiPolygon",
          "wkt": "MULTIPOLYGON (((0.031511538320942 0.018748255720478, 0.034098668372901 0.018748255720478, 0.034098668372901 0.014637411882942, 0.031511538320942 0.014637411882942, 0.031511538320942 0.018748255720478)))",
          "name": "B12"
        }
      },
      {
        "type": "Feature",
        "geometry": {
          "type": "MultiPolygon",
          "coordinates": [
            [
              [
                [
                  0.034206484173301,
                  0.021510610514101
                ],
                [
                  0.036793614225259,
                  0.021510610514101
                ],
                [
                  0.036793614225259,
                  0.014637410978572
                ],
                [
                  0.034206484173301,
                  0.014637411882942
                ],
                [
                  0.034206484173301,
                  0.021510610514101
                ]
              ]
            ]
          ]
        },
        "properties": {
          "sqlgeotype": "MultiPolygon",
          "wkt": "MULTIPOLYGON (((0.034206484173301 0.021510610514101, 0.036793614225259 0.021510610514101, 0.036793614225259 0.014637410978572, 0.034206484173301 0.014637411882942, 0.034206484173301 0.021510610514101)))",
          "name": "B10"
        }
      },
      {
        "type": "Feature",
        "geometry": {
          "type": "MultiPolygon",
          "coordinates": [
            [
              [
                [
                  0.036901430025659,
                  0.021510610514101
                ],
                [
                  0.039937717719678,
                  0.021510610514101
                ],
                [
                  0.039937717719678,
                  0.017911229255581
                ],
                [
                  0.036901430025659,
                  0.017911229255581
                ],
                [
                  0.036901430025659,
                  0.021510610514101
                ]
              ]
            ]
          ]
        },
        "properties": {
          "sqlgeotype": "MultiPolygon",
          "wkt": "MULTIPOLYGON (((0.036901430025659 0.021510610514101, 0.039937717719678 0.021510610514101, 0.039937717719678 0.017911229255581, 0.036901430025659 0.017911229255581, 0.036901430025659 0.021510610514101)))",
          "name": "B10-Køkken"
        }
      },
      {
        "type": "Feature",
        "geometry": {
          "type": "MultiPolygon",
          "coordinates": [
            [
              [
                [
                  0.036901430025659,
                  0.017802686836287
                ],
                [
                  0.039937717719678,
                  0.017802686836287
                ],
                [
                  0.039937717719678,
                  0.014637411882942
                ],
                [
                  0.036901430025659,
                  0.014637411882942
                ],
                [
                  0.036901430025659,
                  0.017802686836287
                ]
              ]
            ]
          ]
        },
        "properties": {
          "sqlgeotype": "MultiPolygon",
          "wkt": "MULTIPOLYGON (((0.036901430025659 0.017802686836287, 0.039937717719678 0.017802686836287, 0.039937717719678 0.014637411882942, 0.036901430025659 0.014637411882942, 0.036901430025659 0.017802686836287)))",
          "name": "B08 indgang"
        }
      },
      {
        "type": "Feature",
        "geometry": {
          "type": "MultiPolygon",
          "coordinates": [
            [
              [
                [
                  0.044530656443674,
                  0.017585789073557
                ],
                [
                  0.042324835394706,
                  0.017585789073557
                ],
                [
                  0.042342629880941,
                  0.015085663757519
                ],
                [
                  0.044530656443674,
                  0.015085663757519
                ],
                [
                  0.044530656443674,
                  0.017585789073557
                ]
              ]
            ]
          ]
        },
        "properties": {
          "sqlgeotype": "MultiPolygon",
          "wkt": "MULTIPOLYGON (((0.044530656443674 0.017585789073557, 0.042324835394706 0.017585789073557, 0.042342629880941 0.015085663757519, 0.044530656443674 0.015085663757519, 0.044530656443674 0.017585789073557)))",
          "name": "B gang trappe"
        }
      },
      {
        "type": "Feature",
        "geometry": {
          "type": "MultiPolygon",
          "coordinates": [
            [
              [
                [
                  0.040045533520078,
                  0.021510610514101
                ],
                [
                  0.044530656443674,
                  0.021510610514101
                ],
                [
                  0.044530656443674,
                  0.017911229255581
                ],
                [
                  0.041050758204475,
                  0.017911229255581
                ],
                [
                  0.041049646090154,
                  0.019659542667776
                ],
                [
                  0.040045533520078,
                  0.019649109862111
                ],
                [
                  0.040045533520078,
                  0.021510610514101
                ]
              ]
            ]
          ]
        },
        "properties": {
          "sqlgeotype": "MultiPolygon",
          "wkt": "MULTIPOLYGON (((0.040045533520078 0.021510610514101, 0.044530656443674 0.021510610514101, 0.044530656443674 0.017911229255581, 0.041050758204475 0.017911229255581, 0.041049646090154 0.019659542667776, 0.040045533520078 0.019649109862111, 0.040045533520078 0.021510610514101)))",
          "name": "B02"
        }
      },
      {
        "type": "Feature",
        "geometry": {
          "type": "MultiPolygon",
          "coordinates": [
            [
              [
                [
                  0.040045533520078,
                  0.017911229255581
                ],
                [
                  0.040045533520078,
                  0.019540562017692
                ],
                [
                  0.040942942404075,
                  0.019549885162081
                ],
                [
                  0.040942942404075,
                  0.017919435690466
                ],
                [
                  0.040045533520078,
                  0.017911229255581
                ]
              ]
            ]
          ]
        },
        "properties": {
          "sqlgeotype": "MultiPolygon",
          "wkt": "MULTIPOLYGON (((0.040045533520078 0.017911229255581, 0.040045533520078 0.019540562017692, 0.040942942404075 0.019549885162081, 0.040942942404075 0.017919435690466, 0.040045533520078 0.017911229255581)))",
          "name": "B02 wc"
        }
      },
      {
        "type": "Feature",
        "geometry": {
          "type": "MultiPolygon",
          "coordinates": [
            [
              [
                [
                  0.007516546240351,
                  0.014528869461869
                ],
                [
                  0.007516545342036,
                  0.012746738013385
                ],
                [
                  0.000846212997641,
                  0.012746728969691
                ],
                [
                  0.000846212997641,
                  0.014528869461869
                ],
                [
                  0.007516546240351,
                  0.014528869461869
                ]
              ]
            ]
          ]
        },
        "properties": {
          "sqlgeotype": "MultiPolygon",
          "wkt": "MULTIPOLYGON (((0.007516546240351 0.014528869461869, 0.007516545342036 0.012746738013385, 0.000846212997641 0.012746728969691, 0.000846212997641 0.014528869461869, 0.007516546240351 0.014528869461869)))",
          "name": "B depot"
        }
      }
    ];

    const testLayer = L.geoJSON(testGeoJSON, {
      style(feature) {
        return {color: feature.properties.color}; // Assign a style based on the geoJSON color property
      }
    }).addTo(this.map);
    this.map.fitBounds(testLayer.getBounds());
    */
    const wallLayer = L.geoJSON(wallsGeoJson, {
      style(feature) {
        return {color: feature.properties.color}; // Assign a style based on the geoJSON color property
      }
    }).addTo(this.map);

    L.geoJSON(roomsGeoJSON, {
      style(feature) {
        return {color: feature.properties.color}; // Assign a style based on the geoJSON color property
      }
    }).addTo(this.map);

    this.addPoi();

    // Zoom to wall layer
    this.map.fitBounds(wallLayer.getBounds());

    this.map.on('zoomend', (e: Event) => {
      ///console.log(this.map._zoom);
      if (this.map._zoom > 15) {
        this.addPoi();
      } else {
        if (this.poiLayer != null){
          this.poiLayer.clearLayers();
          this.poiLayer = null;
        }
      }
    });
    // endregion

  }

  private addPoi(): void {
    if (this.poiLayer == null) {

      const poiGeoJSON = {
        type: 'FeatureCollection',
        name: 'PoiColor',
        crs: {type: 'name', properties: {name: 'urn:ogc:def:crs:OGC:1.3:CRS84'}},
        features: [
          {
            type: 'Feature',
            properties: {id: 1, name: 'Door B30', type: 1},
            geometry: {type: 'Point', coordinates: [0.0121080444777, 0.011890672545024]}
          },
          {
            type: 'Feature',
            properties: {id: 2, name: 'wc3 door', type: 2},
            geometry: {type: 'Point', coordinates: [0.01451197642889, 0.012638195591449]}
          },
          {
            type: 'Feature',
            properties: {id: 3, name: 'wc1 door', type: 2},
            geometry: {type: 'Point', coordinates: [0.015563151047722, 0.012638195591449]}
          },
          {
            type: 'Feature',
            properties: {id: 4, name: 'wc3 door', type: 2},
            geometry: {type: 'Point', coordinates: [0.016687013273176, 0.012638195591449]}
          },
          {
            type: 'Feature',
            properties: {id: 5, name: 'B24 Door', type: 1},
            geometry: {type: 'Point', coordinates: [0.008059553502651, 0.014637411882942]}
          },
          {
            type: 'Feature',
            properties: {id: 5, name: 'B24 door', type: 1},
            geometry: {type: 'Point', coordinates: [0.015160573534127, 0.014637411882942]}
          },
          {
            type: 'Feature',
            properties: {id: 6, name: 'B25', type: 1},
            geometry: {type: 'Point', coordinates: [0.022619440244354, 0.014637411882942]}
          },
          {
            type: 'Feature',
            properties: {id: 6, name: 'InfoStander', type: 3},
            geometry: {type: 'Point', coordinates: [0.015641430008699, 0.005960481864046]}
          },
          {
            type: 'Feature',
            properties: {id: 9, name: 'B Depot dør', type: 1},
            geometry: {type: 'Point', coordinates: [0.007516545803443, 0.013662104880035]}
          },
          {
            type: 'Feature',
            properties: {id: 10, name: 'B14 Dør', type: 1},
            geometry: {type: 'Point', coordinates: [0.030380286509362, 0.014637411882942]}
          },
          {
            type: 'Feature',
            properties: {id: 11, name: 'B14,B12 dør', type: 1},
            geometry: {type: 'Point', coordinates: [0.031464638014316, 0.016193370525657]}
          },
          {
            type: 'Feature',
            properties: {id: 12, name: 'B12 kontor,B12 dør', type: 1},
            geometry: {type: 'Point', coordinates: [0.032740280246298, 0.018801374914496]}
          },
          {
            type: 'Feature',
            properties: {id: 13, name: 'B12,B10 dør', type: 1},
            geometry: {type: 'Point', coordinates: [0.034156054057382, 0.016250090450531]}
          },
          {
            type: 'Feature',
            properties: {id: 14, name: 'B10,B08 dør', type: 1},
            geometry: {type: 'Point', coordinates: [0.036851918722008, 0.016272333558325]}
          },
          {
            type: 'Feature',
            properties: {id: 15, name: 'B08,B08 køkken dør', type: 1},
            geometry: {type: 'Point', coordinates: [0.039314230754796, 0.017856042833253]}
          },
          {
            type: 'Feature',
            properties: {id: 16, name: 'B08 dør', type: 1},
            geometry: {type: 'Point', coordinates: [0.039937717719678, 0.017157609248524]}
          },
          {
            type: 'Feature',
            properties: {id: 17, name: 'B02 wc dør', type: 1},
            geometry: {type: 'Point', coordinates: [0.040513160034591, 0.017915505507589]}
          },
          {
            type: 'Feature',
            properties: {id: 18, name: 'B02 dør', type: 1},
            geometry: {type: 'Point', coordinates: [0.041878861083437, 0.017911229255581]}
          },
          {
            type: 'Feature',
            properties: {id: 19, name: 'B trappe til kælder', type: 4},
            geometry: {type: 'Point', coordinates: [0.042056805945789, 0.015440441326832]}
          },
          {
            type: 'Feature',
            properties: {id: 20, name: 'Atriumgård dør', type: 1},
            geometry: {type: 'Point', coordinates: [0.030508184379177, 0.012557734556738]}
          }
        ]
      };

      const doorIcon = L.icon({
        iconUrl: '/assets/door_white.png',

        iconSize: [30, 30], // size of the icon
        iconAnchor: [15, 15], // point of the icon which will correspond to marker's location
        popupAnchor: [-3, -76] // point from which the popup should open relative to the iconAnchor
      });

      this.poiLayer = L.geoJSON(poiGeoJSON, {
        pointToLayer(feature, latlng) {
          return L.marker(latlng, {icon: doorIcon});
        }
      }).addTo(this.map);
    }
  }

  ngAfterViewInit(): void {
    this.initMap();
  }
}
